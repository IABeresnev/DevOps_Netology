# Домашнее задание к занятию "6.1. Типы и структура СУБД"


## Задача 1

Архитектор ПО решил проконсультироваться у вас, какой тип БД 
лучше выбрать для хранения определенных данных.

Он вам предоставил следующие типы сущностей, которые нужно будет хранить в БД:

- Электронные чеки в json виде  
NoSQL документо-ориентированные(Шаблонный документ идеально подойдет для такой базы) 
- Склады и автомобильные дороги для логистической компании  
NoSQL графовые(в случае расчет оптимального пусти, удобно использовать веса(стоимости) плечей в графе)
- Генеалогические деревья  
NoSQL графовые или иерархические(Графовые если хотим хранить дополнительные свойства или отражать дополнительные "не семейные" связи, иерархические если структура будет строго подчиненной, без обратных связей между уровнями)  
- Кэш идентификаторов клиентов с ограниченным временем жизни для движка аутентификации  
NoSQL Key-Value (быстрое In-memory хранилище будет оптимальным вариантом для частого обращения на чтение и для бОльшего числа одновременных обращений, хранить будет только ключ(имя пользователя) и значение(хеш аутентификации) что является шаблонным вариантом использования)   
- Отношения клиент-покупка для интернет-магазина  
NoSQL Column-oriented(Составляем шаблонное описание вида клиент-строки, список покупок, дата, сумма, вид оплаты... прочие интересующие компанию данные как столбцы. Если интересно что и как часто покупают, то можно детализировать элементы корзины.) 

Выберите подходящие типы СУБД для каждой сущности и объясните свой выбор.

## Задача 2

Вы создали распределенное высоконагруженное приложение и хотите классифицировать его согласно 
CAP-теореме. Какой классификации по CAP-теореме соответствует ваша система, если 
(каждый пункт - это отдельная реализация вашей системы и для каждого пункта надо привести классификацию):

- Данные записываются на все узлы с задержкой до часа (асинхронная запись)
CAP - AP присутствует только доступность и устойчивость к разделению, но о согласованности данных речи не идет.
(When we post to facebook, instagram, then instantly our friends might not see our post.
Comment: This system ensures AP, i.e Availability and Partition Tolerance compromising Consistency.)
Для дополнительной проверки пойдем от обратного.
Предположим что тут есть Сonsistency, но Consistency подразумевает получение возможности чтения "свежих" записанных данных. Что в нашем случае невозможно по условия задачи.
Cогласованность данных (англ. consistency) — во всех вычислительных узлах в один момент времени данные не противоречат друг другу;
P - partition tolerance, можем предложить её наличие так как есть асинхронная запись на все узлы, значит информация при разделении будет доступна с функционирующих узлов. 
Вывод CP и АС тут нет.
PACELC - PA/EL - Устойчива к разделению, а при разделении сохраняется высокую скорость ответа.
!!!НО!!!
Если взять за пример не посты в соц сетях, а например распределенная служба Active Directory.
Тогда получается что система становиться CA, так как в такой системе есть синхронизация, но к разделению, а точнее к автоматическому восстановлению после разделения она не умеет.
PACELC - PC/EL
Было бы больше данных по параметру P, было бы проще понять как категоризировать.
- При сетевых сбоях, система может разделиться на 2 раздельных кластера
AP присутствует только доступность и устойчивость к разделению, но о согласованности данных речи не идет.
PACELC - PA/EL - Устойчива к разделению, а при разделении сохраняется высокую скорость ответа.
После разделения пропадет согласованность данных.
- Система может не прислать корректный ответ или сбросить соединение
CP есть проблема с доступностью, остается согласованность и устойчивость к разделению.
PACELC - PC/EC - Сложновато, но предположу что в данном случае жертвуют доступность и скоростью в угоду консистентности данных.  

## Задача 3

Могут ли в одной системе сочетаться принципы BASE и ACID? Почему?
Я думаю, что это невозможно. Принципы BASE целиком и полностью противопоставлены ACID. Базы данных созданные для соблюдения принципа BASE,
не могут отвечать принципам ACID. Цели и задачи которые преследует и решают созданные по разным принципам базы данных также различны.

## Задача 4

Вам дали задачу написать системное решение, основой которого бы послужили:

- фиксация некоторых значений с временем жизни
подошло бы key-value хранилище, где key - было бы уникальное значение времени.
- реакция на истечение таймаута
Не совсем понимаю, о чем идет речь.

Вы слышали о key-value хранилище, которое имеет механизм [Pub/Sub](https://habr.com/ru/post/278237/). 
Что это за система? Какие минусы выбора данной системы?
Такой системой является Redis - это key-value хранилище, которое имеется функционал pub/sub.
Высокая скорость работы системы, но для передачи данных(корректной отправки и приема сообщения) между подписчиком и отправителем, они должны быть оба подключены
в одно время к базе. Данные во время работы сервера хранить In-memory в оперативной памяти. 
Имеет возможность сохранение данных либо через механизм снепшотов раз в некоторое время(устанавливается пользователем)
или ведение журнала, логирование операций записи и в случае сбоя восстановить операции, но в режиме логирование система будет медленее.
Можно запретить любое долговременное хранение, тогда система будем максимально быстрой, но о надежности в момент сбоя\перезагрузки речи не идет.
---
