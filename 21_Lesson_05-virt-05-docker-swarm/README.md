# Домашнее задание к занятию "5.5. Оркестрация кластером Docker контейнеров на примере Docker Swarm"


---

## Задача 1

Дайте письменые ответы на следующие вопросы:

- В чём отличие режимов работы сервисов в Docker Swarm кластере: replication и global?
Режим Global запустит задачи на всех нодах кластера, Replicant только на заданном количестве.
- Какой алгоритм выбора лидера используется в Docker Swarm кластере?
Используется алгоритм под названием RAFT. Использовать механизм необходимо для согласования всех управляющих нод.
Определение главной ноды проходит через "голосование", таймер голосование на каждой ноде свой. За счет разницы таймеров,
в случае отсутствия определения главной ноды в первом круге, проходит второй и последующие этапы до успешного определения
главной ноды.
- Что такое Overlay Network?
Это сеть автоматически создаваемая поверх основной сети для связи и передачи данных между нодами кластера Docker Swarm.
Подобные сети при необходимости можно создавать дополнительно руками или скриптами. При инициализации кластера или
подключения дополнительно хоста в кластер. На нем автоматически создается 2 overlay сети:
- ingress для передачи данных и управления между сервисами кластера
- docker_gwbridge для соединения Docker-демонов между собой в кластере Swarm.

## Задача 2

Создать ваш первый Docker Swarm кластер в Яндекс.Облаке

Для получения зачета, вам необходимо предоставить скриншот из терминала (консоли), с выводом команды:
```
docker node ls
```  
![task2!](/21_Lesson_05-virt-05-docker-swarm/images/task2.png)<br>

## Задача 3

Создать ваш первый, готовый к боевой эксплуатации кластер мониторинга, состоящий из стека микросервисов.

Для получения зачета, вам необходимо предоставить скриншот из терминала (консоли), с выводом команды:
```
docker service ls
```  
![task3!](/21_Lesson_05-virt-05-docker-swarm/images/task3.png)<br>


## Задача 4 (*)

Выполнить на лидере Docker Swarm кластера команду (указанную ниже) и дать письменное описание её функционала, что она делает и зачем она нужна:
```
# см.документацию: https://docs.docker.com/engine/swarm/swarm_manager_locking/
docker swarm update --autolock=true
```

Команда блокирует ключи шифрования используемые для кодирования логов Raft и передаваемого в кластере трафика.
После перезапуска кластера, для его полноценного запуска нам необходимо стать владельцем ключей и в ручном режиме запустить кластер.

```[centos@node01 ~]$ sudo docker swarm update --autolock=true
Swarm updated.
To unlock a swarm manager after it restarts, run the `docker swarm unlock`
command and provide the following key:

    SWMKEY-1-dp5QbT/C/a06wTBUnb12cpZBu9mEqeLU+NsjZ+pcM1w

Please remember to store this key in a password manager, since without it you
will not be able to restart the manager.
```